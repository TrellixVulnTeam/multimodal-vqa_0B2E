# Predicting SGG on training set
python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /home/fxx/scene_graph_generation MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /home/fxx/scene_graph_generation/subsetImages/training DETECTED_SGG_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet/training

# Predicting SGG on full image set
python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /home/fxx/scene_graph_generation MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /home/fxx/scene_graph_generation/subsetImages/training_fullset_part1 DETECTED_SGG_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet/training_fullset_part1

python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /home/fxx/scene_graph_generation MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /home/fxx/scene_graph_generation/subsetImages/training_fullset_part2 DETECTED_SGG_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet/training_fullset_part2

python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /media/fxx/Large_Store/multimodal_ml/code/Scene-Graph-Benchmark.pytorch/glove MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /media/fxx/Large_Store/multimodal_ml/gqa_dataset/allImages/images DETECTED_SGG_DIR /media/fxx/Large_Store/multimodal_ml/gqa_dataset/sceneGraphs/training_generated

# Predicting SGG on val set
python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /home/fxx/scene_graph_generation MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /home/fxx/scene_graph_generation/subsetImages/validation DETECTED_SGG_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet/validation/

# Predicting SGG on testdev set
python tools/relation_test_net.py --config-file "configs/e2e_relation_X_101_32_8_FPN_1x.yaml" MODEL.ROI_RELATION_HEAD.USE_GT_BOX False MODEL.ROI_RELATION_HEAD.USE_GT_OBJECT_LABEL False MODEL.ROI_RELATION_HEAD.PREDICTOR CausalAnalysisPredictor MODEL.ROI_RELATION_HEAD.CAUSAL.EFFECT_TYPE TDE MODEL.ROI_RELATION_HEAD.CAUSAL.FUSION_TYPE sum MODEL.ROI_RELATION_HEAD.CAUSAL.CONTEXT_LAYER motifs TEST.IMS_PER_BATCH 1 DTYPE "float16" GLOVE_DIR /home/fxx/scene_graph_generation MODEL.PRETRAINED_DETECTOR_CKPT /home/fxx/scene_graph_generation/upload_causal_motif_sgdet OUTPUT_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet TEST.CUSTUM_EVAL True TEST.CUSTUM_PATH /home/fxx/scene_graph_generation/subsetImages/testdev DETECTED_SGG_DIR /home/fxx/scene_graph_generation/upload_causal_motif_sgdet/testdev